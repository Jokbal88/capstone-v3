{% extends 'mainv2.html' %} 
{% load static tailwind_tags %} 
{% block title %}HealthHub Connect | Patient Profile{% endblock %} 
{% block extra_css %}
{% tailwind_css %}
{% endblock %}

{% block content %}
<div class="w-full h-screen rounded-[14px] bg-white xs:p-4 md:p-8 flex flex-col gap-2">
  <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-4 border-b pb-4 mb-2">
    <div>
      <h2 class="font-bold text-2xl text-gray-800">Patient Profile</h2>
      <p class="text-gray-500 text-sm">Search and view patient records</p>
    </div>
    <form method="POST" class="flex items-center gap-2 w-full md:w-auto">
      {% csrf_token %}
      <input class="p-2 border border-gray-300 rounded-md w-full md:w-64 text-base focus:ring-2 focus:ring-blue-200" type="text" name="student_id" placeholder="Enter ID to search" />
      <button class="bg-blue-500 hover:bg-blue-600 text-white text-base px-4 py-2 rounded-md transition-colors" type="submit">Search</button>
    </form>
  </div>
  <div class="overflow-x-auto">
    <table class="w-full table-auto border-separate border-spacing-0 rounded-lg overflow-hidden shadow-lg text-lg">
      <thead class="bg-gray-100">
        <tr>
          <th class="text-center p-4 text-lg font-semibold text-gray-700">Student ID</th>
          <th class="text-center p-4 text-lg font-semibold text-gray-700">Lastname</th>
          <th class="text-center p-4 text-lg font-semibold text-gray-700">Firstname</th>
          <th class="text-center p-4 text-lg font-semibold text-gray-700">Degree</th>
          <th class="text-center p-4 text-lg font-semibold text-gray-700">Year Level</th>
          <th class="text-center p-4 text-lg font-semibold text-gray-700">Sex</th>
          <th class="text-center p-4 text-lg font-semibold text-gray-700">Actions</th>
        </tr>
      </thead>
      <tbody>
        {% for patient in patients %}
        <tr class="{% if forloop.counter0|divisibleby:2 %}bg-gray-100{% else %}bg-white{% endif %} hover:bg-blue-50 transition-colors">
          <td class="text-center p-4">
            <span class="text-black">
              {% if patient.user.student %}
                {{ patient.user.student.student_id }}
              {% elif patient.user.faculty %}
                {{ patient.user.faculty.faculty_id }}
              {% else %}
                {{ patient.user.username }}
              {% endif %}
            </span>
          </td>
          <td class="text-center p-4">
            <span class="text-black">{{ patient.user.last_name|title }}</span>
          </td>
          <td class="text-center p-4">
            <span class="text-black">{{ patient.user.first_name|title }}</span>
          </td>
          <td class="text-center p-4">
            <span class="text-black">
              {% if patient.user.student %}
                {{ patient.user.student.degree }}
              {% elif patient.user.faculty %}
                {{ patient.user.faculty.department }}
              {% else %}
                N/A
              {% endif %}
            </span>
          </td>
          <td class="text-center p-4">
            <span class="text-black">
              {% if patient.user.student %}
                {{ patient.user.student.year_level }}
              {% elif patient.user.faculty %}
                {{ patient.user.faculty.position }}
              {% else %}
                N/A
              {% endif %}
            </span>
          </td>
          <td class="text-center p-4">
            <span class="text-black">
              {% if patient.user.student %}
                {{ patient.user.student.sex }}
              {% elif patient.user.faculty %}
                {{ patient.user.faculty.sex }}
              {% else %}
                N/A
              {% endif %}
            </span>
          </td>
          <td class="text-center p-4">
            {% if patient.user.student %}
              <a href="{% url 'medical:physical_exam' patient.user.student.student_id %}" class="inline-block bg-blue-500 hover:bg-blue-700 text-white font-semibold py-2 px-4 rounded shadow transition-colors">View</a>
            {% elif patient.user.faculty %}
              <a href="{% url 'medical:physical_exam' patient.user.faculty.faculty_id %}" class="inline-block bg-blue-500 hover:bg-blue-700 text-white font-semibold py-2 px-4 rounded shadow transition-colors">View</a>
            {% else %}
              <span class="text-gray-500">N/A</span>
            {% endif %}
          </td>
        </tr>
        {% empty %}
        <tr>
          <td colspan="7" class="text-center p-4 text-gray-500">No patients found</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>

{% endblock %}
{% block extra_js %}
{% endblock %}
